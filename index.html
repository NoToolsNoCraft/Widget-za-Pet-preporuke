<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pet Profile Widget for Retail Websites</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />
  <style>
    body {
      font-family: 'Arial', sans-serif;
      background-color: #f3f4f6;
      color: #1f2937;
    }
    .linkedin-blue {
      color: #0a66c2;
    }
    .cta-button {
      background-color: #0a66c2;
      color: white;
      transition: background-color 0.3s ease;
    }
    .cta-button:hover {
      background-color: #004182;
    }
    .email-button {
      background-color: #f97316;
      color: white;
      transition: background-color 0.3s ease;
    }
    .email-button:hover {
      background-color: #ea580c;
    }

    /* Custom styles for Pet Centar branding */
    .pet-centar-btn {
      background-color: #f97316;
      transition: background-color 0.3s ease, transform 0.2s ease;
     
    }
    .pet-centar-btn:hover {
      background-color: #ea580c;
      transform: scale(1.05);
    }
    .pet-centar-modal {
      position: fixed;
      top: 0;
      right: -100%;
      width: 320px;
      height: 100vh;
      background: white;
      border-left: 2px solid #f97316;
      box-shadow: -4px 0 20px rgba(0, 0, 0, 0.1);
      transition: right 0.3s ease-in-out;
      z-index: 50;
      overflow-y: auto;
      padding-top: 1rem;
    }
    .pet-centar-modal.open {
      right: 0;
    }
    .paw-icon::before {
      content: '🐾';
      margin-right: 8px;
      font-size: 1.5rem;
      vertical-align: middle;
    }
    input:focus, select:focus, button:focus {
      outline: 2px solid #f97316;
      outline-offset: 2px;
    }
    
    /* Error message styling */
    .error-message {
      color: #dc2626;
      font-size: 0.875rem;
      margin-top: 0.5rem;
      display: none;
    }
    .error-message.visible {
      display: block;
    }
    /* Confirmation dialog styling, inside modal */
    .confirmation-dialog {
      display: none;
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      z-index: 60;
      justify-content: center;
      align-items: center;
    }
    .confirmation-dialog.open {
      display: flex;
    }
    .confirmation-content {
      background: white;
      padding: 1.5rem;
      border-radius: 8px;
      border: 2px solid #f97316;
      max-width: 90%;
      text-align: center;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    .confirmation-content button {
      margin: 0.5rem;
      padding: 0.5rem 1rem;
      border-radius: 4px;
    }
    /* Sticky button styling */
    .sticky-button {
      position: fixed;
      top: 1rem;
      right: 1rem;
      z-index: 60;
    }

    @media (max-width: 500px) {
      .sticky-button {
        top: 6rem;
      }
      .pet-centar-modal {
        width: 100%;
      }
    }
    
    /* Remove button styling */
    .remove-button {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 24px;
      height: 24px;
      background-color: #f97316;
      color: white;
      border-radius: 50%;
      border: 1px solid #ea580c;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      transition: background-color 0.3s ease, transform 0.2s ease;
    }
    .remove-button:hover {
      background-color: #ea580c;
      transform: scale(1.1);
    }
    .remove-button:focus {
      outline: 2px solid #f97316;
      outline-offset: 2px;
    }
    /* Close button styling */
    .close-button {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 24px;
      height: 24px;
      background-color: #f97316;
      color: white;
      border-radius: 50%;
      border: 1px solid #ea580c;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      transition: background-color 0.3s ease, transform 0.2s ease;
    }
    .close-button:hover {
      background-color: #ea580c;
      transform: scale(1.1);
    }
    .close-button:focus {
      outline: 2px solid #f97316;
      outline-offset: 2px;
    }
    /* Profile container styling */
    .profile-container {
      display: flex;
      flex-direction: column;
      position: relative;
      padding-right: 32px;
      margin-bottom: 1rem;
    }
    /* Slogan styling */
    .slogan {
      font-style: italic;
      color: #f97316;
      font-size: 0.875rem;
      margin-bottom: 0.5rem;
    }
    /* Intro text styling */
    .intro-text {
      font-size: 0.875rem;
      color: #1f2937;
      margin-bottom: 1rem;
    }
    /* Flex container for breed and age fields */
    .field-row {
      display: flex;
      gap: 0.5rem;
      margin-bottom: 1rem;
    }
    .field-row > div:first-child { /* Breed field */
      flex: 3; /* Takes up more space */
    }
    .field-row > div:last-child { /* Age field */
      flex: 2; /* Takes up less space */
    }
    /* Dog icon styling */
    .dog-icon {
      font-size: 1.25rem;
      margin-right: 0.5rem;
      vertical-align: middle;
    }
  </style>
</head>
<body class="min-h-screen flex flex-col">
  <header class="bg-white shadow">
    <div class="max-w-6xl mx-auto px-4 py-6">
      <h1 class="text-2xl font-semibold">Widget za Preporuke na Osnovu Profila Ljubimca</h1>
    </div>
  </header>

  <main class="flex-grow">
    <section class="max-w-6xl mx-auto px-4 py-10">
      <div class="grid md:grid-cols-2 gap-10 items-center">
        <div>
          <h2 class="text-3xl font-bold mb-4">Zainteresujte Vlasnike Ljubimaca Personalizovanim Preporukama</h2>
          <p class="mb-4 text-lg leading-relaxed">
            Ovaj interaktivni widget omogućava vašim posetiocima da kreiraju profil svog ljubimca i odmah dobiju personalizovane preporuke proizvoda. Idealan je za veb-sajtove koji prodaju hranu za ljubimce, suplemente, igračke i slično — kao što je
            <a href="https://www.pet-centar.rs/" target="_blank" rel="noopener noreferrer" class="linkedin-blue underline">Pet Centar</a>.
          </p>
          <p class="mb-4 text-lg">
            Kada korisnik unese ime, vrstu, rasu i starost ljubimca, widget automatski predlaže odgovarajuće proizvode iz vaše ponude — povećavajući angažman i konverzije.
          </p>
          <p class="mb-6 text-lg">
            Isprobajte dodatak na ovoj stranici klikom na dugme <strong class="font-semibold">"Dodaj svog ljubimca"</strong> u gornjem desnom uglu.
          </p>
          <div class="flex space-x-4">
            <a href="https://www.linkedin.com/in/petar-skrbic/" target="_blank" rel="noopener noreferrer">
              <button class="cta-button px-6 py-3 rounded-lg font-semibold text-white shadow-md">
                Kontaktirajte me preko LinkedIna
              </button>
            </a>
            <a href="mailto:notoolsnocraft@gmail.com">
              <button class="email-button px-6 py-3 rounded-lg font-semibold text-white shadow-md">
                Kontaktirajte me putem e-pošte
              </button>
            </a>
          </div>
        </div>
        <div>
          <img src="https://cdn-icons-png.flaticon.com/512/616/616408.png" alt="Ilustracija profila ljubimca" class="w-full max-w-md mx-auto" />
        </div>
      </div>
    </section>
  </main>

  <footer class="bg-white border-t">
    <div class="max-w-6xl mx-auto px-4 py-6 text-center text-sm text-gray-500">
      &copy; 2025 Widget za Profil Ljubimca. Autor: <a class="underline text-blue-600" href="https://www.linkedin.com/in/petar-skrbic/" target="_blank">Petar Škrbić</a>.
    </div>
  </footer>

  <div class="sticky-button" role="region" aria-label="Widget za profil kućnog ljubimca">
    <button
      id="toggle-button"
      class="pet-centar-btn text-white p-1.5 rounded-full shadow-lg flex items-center focus:ring-2 focus:ring-orange-500"
      aria-expanded="false"
      aria-label="Otvori/zatvori obrazac za profil kućnog ljubimca"
    >
      <span class="paw-icon"></span>
      Dodaj svog ljubimca
    </button>
    <div id="pet-profile-modal" class="pet-centar-modal bg-white p-6" role="dialog" aria-labelledby="pet-profile-title">
      <button
        id="close-modal"
        class="close-button absolute top-2 right-2"
        aria-label="Zatvori obrazac za profil kućnog ljubimca"
      >
        ✕
      </button>
      <h2 id="pet-profile-title" class="text-xl font-bold mb-4 text-gray-800">
        <span class="dog-icon">🐶</span>Kreiraj profil ljubimca
      </h2>
      <p class="slogan">Unesite podatke o svom ljubimcu i dobijte personalizovane preporuke proizvoda!</p>
      
      <div class="mb-4">
        <label for="pet-name" class="block text-sm font-medium text-gray-700">Ime ljubimca</label>
        <input
          id="pet-name"
          type="text"
          placeholder="npr. Max"
          class="w-full p-2 border rounded focus:ring-2 focus:ring-orange-500"
          aria-required="true"
        />
      </div>
      <div class="mb-4">
        <label for="pet-type" class="block text-sm font-medium text-gray-700">Vrsta ljubimca</label>
        <select
          id="pet-type"
          class="w-full p-2 border rounded focus:ring-2 focus:ring-orange-500"
          aria-required="true"
        >
          <option value="">Odaberi vrstu</option>
          <option value="Pas">Pas</option>
          <option value="Mačka">Mačka</option>
          <option value="Ptica">Ptica</option>
          <option value="Riba">Riba</option>
        </select>
      </div>
      <div class="field-row">
        <div>
          <label for="pet-breed" class="block text-sm font-medium text-gray-700">Pasmina</label>
          <input
            id="pet-breed"
            type="text"
            placeholder="npr. Labrador"
            list="breed-suggestions"
            class="w-full p-2 border rounded focus:ring-2 focus:ring-orange-500"
            aria-required="true"
          />
          <datalist id="breed-suggestions"></datalist>
        </div>
        <div>
          <label for="pet-age" class="block text-sm font-medium text-gray-700">Dob (godine)</label>
          <input
            id="pet-age"
            type="number"
            placeholder="npr. 2"
            min="0"
            class="w-full p-2 border rounded focus:ring-2 focus:ring-orange-500"
            aria-required="true"
          />
        </div>
      </div>
      <button
        id="save-profile"
        class="pet-centar-btn text-white p-2 rounded w-full focus:ring-2 focus:ring-orange-500"
        aria-label="Spremi profil ljubimca"
      >
        Spremi profil
      </button>
      <div id="error-message" class="error-message" role="alert">Molimo ispunite sva polja.</div>
      <div id="profiles-list" class="mt-6"></div>
      <div id="confirmation-dialog" class="confirmation-dialog" role="dialog" aria-labelledby="confirm-title">
        <div class="confirmation-content">
          <h3 id="confirm-title" class="text-lg font-bold mb-4">Ukloni ljubimca</h3>
          <p id="confirm-message" class="mb-4">Jeste li sigurni da želite ukloniti ovog ljubimca?</p>
          <button
            id="confirm-remove"
            class="pet-centar-btn text-white focus:ring-2 focus:ring-orange-500"
            aria-label="Potvrdi uklanjanje ljubimca"
          >
            Potvrdi
          </button>
          <button
            id="cancel-remove"
            class="text-gray-500 hover:text-gray-700 focus:ring-2 focus:ring-orange-500"
            aria-label="Odustani od uklanjanja ljubimca"
          >
            Odustani
          </button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Product recommendations with .rs URLs and RSD prices
    const products = {
      'Pas-Labrador': [
        { name: 'Royal Canin Labrador Retriever Adult 12kg', url: 'https://www.pet-centar.rs/products/royal-canin-bhn-labrador-retriever-adult', price: '11.359 RSD' },
        { name: 'Foresto Ogrlica za pse 70cm', url: 'https://www.pet-centar.rs/products/foresto-elanco-ogrlica-za-pse-protiv-buva-i-krpelja-8kg-70cm', price: '5.599 RSD' }
      ],
      'Pas-Beagle': [
        { name: 'Brit Premium by Nature Adult M 15kg', url: 'https://www.pet-centar.rs/products/brit-premium-by-nature-adult-medium-breeds', price: '4.899 RSD' }
      ],
      'Mačka-Persian': [
        { name: 'Royal Canin Persian Adult 4kg', url: 'https://www.pet-centar.rs/products/royal-canin-fbn-adult-persian', price: '6.599 RSD' },
        { name: 'Fypryst Combo Cat 0.5ml', url: 'https://www.pet-centar.rs/products/fypryst-combo-krka-ampula-spoton-za-macke-i-feretke-50mg-05ml', price: '749 RSD' }
      ],
      'Mačka-Maine Coon': [
        { name: 'Royal Canin Maine Coon Adult 10kg', url: 'https://www.pet-centar.rs/products/royal-canin-fbn-adult-maine-coon', price: '13.999 RSD' }
      ],
      'default': [
        { name: 'Istraži sve proizvode', url: 'https://www.pet-centar.rs/collections/svi-proizvodi', price: '' }
      ]
    };

    // Breed suggestions for each pet type
    const breedSuggestions = {
      'Pas': ['Labrador', 'Beagle', 'Njemački ovčar', 'Zlatni retriver', 'Pudlica'],
      'Mačka': ['Perzijska', 'Maine Coon', 'Sijamska', 'Bengalska', 'Britanska kratkodlaka'],
      'Ptica': ['Papiga', 'Kanarinac', 'Korela', 'Tigrica', 'Ara'],
      'Riba': ['Zlatna ribica', 'Betta', 'Guppy', 'Neonka', 'Diskus'],
      '': []
    };

    // DOM elements
    const toggleButton = document.getElementById('toggle-button');
    const modal = document.getElementById('pet-profile-modal');
    const closeButton = document.getElementById('close-modal');
    const saveButton = document.getElementById('save-profile');
    const petNameInput = document.getElementById('pet-name');
    const petTypeSelect = document.getElementById('pet-type');
    const petBreedInput = document.getElementById('pet-breed');
    const breedSuggestionsList = document.getElementById('breed-suggestions');
    const petAgeInput = document.getElementById('pet-age');
    const profilesList = document.getElementById('profiles-list');
    const errorMessage = document.getElementById('error-message');
    const confirmationDialog = document.getElementById('confirmation-dialog');
    const confirmRemoveButton = document.getElementById('confirm-remove');
    const cancelRemoveButton = document.getElementById('cancel-remove');
    const confirmMessage = document.getElementById('confirm-message');

    // Load saved profiles from localStorage
    let profiles = JSON.parse(localStorage.getItem('petProfiles') || '[]');
    let profileToRemove = null;

    // Get product recommendations
    function getRecommendations(profile) {
      const key = `${profile.type}-${profile.breed}`;
      return products[key] || products['default'];
    }

    // Update breed suggestions based on pet type and user input
    function updateBreedSuggestions() {
      const selectedType = petTypeSelect.value;
      const userInput = petBreedInput.value.trim().toLowerCase();
      breedSuggestionsList.innerHTML = '';
      const breeds = breedSuggestions[selectedType] || [];
      const filteredBreeds = userInput
        ? breeds.filter(breed => breed.toLowerCase().startsWith(userInput))
        : breeds;
      filteredBreeds.forEach(breed => {
        const option = document.createElement('option');
        option.value = breed;
        breedSuggestionsList.appendChild(option);
      });
    }

    // Render profiles
    function renderProfiles() {
      profilesList.innerHTML = '';
      if (profiles.length > 0) {
        const header = document.createElement('h3');
        header.className = 'text-lg font-bold mb-2 text-gray-800';
        header.textContent = 'Vaši ljubimci';
        profilesList.appendChild(header);

        profiles.forEach((profile, index) => {
          const profileDiv = document.createElement('div');
          profileDiv.className = 'mb-4 border-b pb-2 profile-container';

          const profileInfo = document.createElement('p');
          profileInfo.className = 'font-bold text-gray-800';
          profileInfo.textContent = `${profile.name} (${profile.type}, ${profile.breed}, ${profile.age} godina)`;
          profileDiv.appendChild(profileInfo);

          const removeButton = document.createElement('button');
          removeButton.className = 'remove-button absolute top-0 right-0';
          removeButton.innerHTML = '✕';
          removeButton.setAttribute('aria-label', `Ukloni ljubimca ${profile.name}`);
          removeButton.addEventListener('click', () => {
            profileToRemove = index;
            confirmMessage.textContent = `Jeste li sigurni da želite ukloniti ljubimca ${profile.name}?`;
            confirmationDialog.classList.add('open');
            confirmRemoveButton.focus();
          });
          profileDiv.appendChild(removeButton);

          const recHeader = document.createElement('h4');
          recHeader.className = 'text-sm font-medium mt-2';
          recHeader.textContent = `Preporučeno za ${profile.name}`;
          profileDiv.appendChild(recHeader);

          const recommendations = getRecommendations(profile);
          recommendations.forEach(product => {
            const link = document.createElement('a');
            link.href = product.url;
            link.className = 'block text-blue-600 hover:underline mt-1';
            link.target = '_blank';
            link.rel = 'noopener noreferrer';
            link.textContent = product.name + (product.price ? ` (${product.price})` : '');
            profileDiv.appendChild(link);
          });

          profilesList.appendChild(profileDiv);
        });
      }
    }

    // Save profile
    function saveProfile() {
      const name = petNameInput.value.trim();
      const type = petTypeSelect.value;
      const breed = petBreedInput.value.trim();
      const age = petAgeInput.value;

      if (!name || !type || !breed || !age) {
        errorMessage.classList.add('visible');
        errorMessage.focus();
        return;
      }

      errorMessage.classList.remove('visible');
      const newProfile = { name, type, breed, age };
      profiles.push(newProfile);
      localStorage.setItem('petProfiles', JSON.stringify(profiles));
      petNameInput.value = '';
      petTypeSelect.value = '';
      petBreedInput.value = '';
      petAgeInput.value = '';
      updateBreedSuggestions();
      renderProfiles();
      petNameInput.focus();
    }

    // Remove profile
    function removeProfile() {
      if (profileToRemove !== null) {
        profiles.splice(profileToRemove, 1);
        localStorage.setItem('petProfiles', JSON.stringify(profiles));
        profileToRemove = null;
        confirmationDialog.classList.remove('open');
        renderProfiles();
        petNameInput.focus();
      }
    }

    // Toggle modal
    function toggleModal() {
      const isOpen = modal.classList.toggle('open');
      toggleButton.setAttribute('aria-expanded', isOpen);
      if (isOpen) {
        petNameInput.focus();
        errorMessage.classList.remove('visible');
        updateBreedSuggestions();
      }
      confirmationDialog.classList.remove('open');
    }

    // Handle keyboard navigation
    function handleKeyDown(e) {
      if (e.key === 'Escape') {
        modal.classList.remove('open');
        toggleButton.setAttribute('aria-expanded', 'false');
        errorMessage.classList.remove('visible');
        confirmationDialog.classList.remove('open');
        toggleButton.focus();
      }
    }

    // Event listeners
    toggleButton.addEventListener('click', toggleModal);
    closeButton.addEventListener('click', () => {
      modal.classList.remove('open');
      toggleButton.setAttribute('aria-expanded', 'false');
      errorMessage.classList.remove('visible');
      confirmationDialog.classList.remove('open');
    });
    saveButton.addEventListener('click', saveProfile);
    modal.addEventListener('keydown', handleKeyDown);
    confirmRemoveButton.addEventListener('click', removeProfile);
    cancelRemoveButton.addEventListener('click', () => {
      confirmationDialog.classList.remove('open');
      profileToRemove = null;
      petNameInput.focus();
    });
    petTypeSelect.addEventListener('change', updateBreedSuggestions);
    petBreedInput.addEventListener('input', updateBreedSuggestions);

    // Initial render
    renderProfiles();
  </script>
</body>
</html>
